<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Beamer Player</title>
    <style>
      html, body {
        margin: 0;
        padding: 0;
        width: 100%;
        height: 100%;
        background: black;
        color: white;
        font-family: system-ui, sans-serif;
        display: flex;
        align-items: center;
        justify-content: center;
      }
      #root {
        text-align: center;
        max-width: 90vw;
        word-wrap: break-word;
      }
      img {
        margin-top: 20px;
        max-width: 90vw;
        max-height: 80vh;
        object-fit: contain;
      }
    </style>
  </head>
  <body>
    <div id="root">Starting player...</div>

    <script>
      const root = document.getElementById("root");

      (async () => {
        try {
          // Load the compiled player-core module
          const playerCore = require("../player-core/dist/index.js");
          const initPlayer = playerCore.initPlayer || playerCore.default || playerCore;

          if (typeof initPlayer !== "function") {
            root.innerText = "Player error: initPlayer is not a function";
            console.error("playerCore module:", playerCore);
            return;
          }

          function renderCreative(creative) {
            root.innerHTML = `
              <div>Now Playing:</div>
              <div><strong>${creative.creative_id}</strong></div>
              <div>${creative.type} - ${creative.duration_seconds}s</div>
              <img src="${creative.file_url}" alt="Creative" />
            `;
          }

          await initPlayer(renderCreative);
        } catch (err) {
          console.error(err);
          root.innerText = "Player error: " + (err && err.message ? err.message : String(err));
        }
      })();
    </script>
  </body>
</html>
